--- 
layout: post
title: 泛型与可变参数
date: 2018-11-12
tags: java
---
### **协变与逆变**
协变：子类当作父类使用，安全，因为父类的功能子类都有，所以子类可以当作父类使用  
逆变：父类当作子类使用，不安全，因为子类的部分功能父类没有
### **定义泛型方法，只需将泛型参数列表置于返回值之前**
``` 
public class GenericMethods {
//当方法操作的引用数据类型不确定的时候，可以将泛型定义在方法上
	public <T> void f(T x){
		System.out.println(x.getClass().getName());
	}
	public static void main(String[] args) {
		GenericMethods gm = new GenericMethods();
		gm.f(99);
		gm.f("你好");
		gm.f(new Integer(99));
		gm.f(18.88);
		gm.f('a');
		gm.f(gm);
	}
}
/* 输出结果：
java.lang.Integer
java.lang.String
java.lang.Integer
java.lang.Double
java.lang.Character
Generics.GenericMethods
 */
```
### **可变参数与泛型方法**
``` 
import java.util.ArrayList;
import java.util.List;
public class GenericVarargs {
	public static <T> List<T> makeList(T... args){
		List<T> result = new ArrayList<T>();
		for(T item:args)
			result.add(item);
		return result;		 
	}
	public static void main(String[] args) {
		List ls = makeList("A");
		System.out.println(ls);
		ls = makeList("A","B","C");
		System.out.println(ls);
		ls = makeList("ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""));
		System.out.println(ls);
	}
}
/*
[A]
[A, B, C]
[A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z]
*/
```
### **泛型的好处**
泛型的一个重要好处是能够简单而安全地创建复杂的模型。如List元组。
``` 
package Generics;
import java.util.ArrayList;
class ThreeTuple2<A,B,C>{
	public final A first;
	public final B second;
	private final C three;
	public ThreeTuple2(A a,B b,C c){
		first = a;
		second = b;
		three = c;
	}
	public String toString(){
		return "(" + first + "," + second + "," + three + ")";
	}
}
public class TupleList<A,B,C> extends ArrayList<ThreeTuple2<A,B,C>> {
	static ThreeTuple2<Integer,String,Character> h(){
		return new ThreeTuple2<Integer,String,Character>(99,"掌上洪城",'a');
	}
	public static void main(String[] args) {
		TupleList<Integer,String,Character> ts = new TupleList<Integer,String,Character>();
		ts.add(h());
		ts.add(h());
		for(ThreeTuple2<Integer,String,Character> ttp:ts)
		System.out.println(ttp);		
	}
}
/* 输出结果为：
(99,掌上洪城,a)
(99,掌上洪城,a)
 */
```
### **泛型限定（上限和下限）的表达式是怎样的？**
上限：？extends E：可以接收E类型或者E的子类型对象。  
下限：？super E：可以接收E类型或者E的父类型对象。  
上限什么时候用：往集合中添加元素时，既可以添加E类型对象，又可以添加E的子类型对象。为什么？因为取的时候，E类型既可以接收E类对象，又可以接收E的子类型对象。  
下限什么时候用：当从集合中获取元素进行操作的时候，可以用当前元素的类型接收，也可以用当前元素的父类型接收。  
### **可变参数**
可变参数的特点：
（1）、只能出现在参数列表的最后；   
（2）、...位于变量类型和变量名之间，前后有无空格都可以；  
（3）、调用可变参数的方法时，编译器为该可变参数隐含创建一个数组，在方法体中一数组的形式访问可变参数。  
``` 
public class Varable {
 public static void main(String [] args){
  System.out.println(add(2,3));
  System.out.println(add(2,3,5));
 }
 public static int add(int x,int ...args){
  int sum=x;
  for(int i=0;i<args.length;i++){
   sum+=args[i];
  }
  return sum;
 }
}
```
