--- 
layout: post
title: 执行器
date: 2018-11-19
tags: Mybatis
---
**执行器（Executor）：**调度StatementHandler、ParameterHandler、ResultHandler等来执行对应的SQL。  
### **SimpleExecutor**
每执行一次update或select，就开启一个Statement对象，用完立刻关闭Statement对象。  
### **ReuseExecutor**
执行update或select，以sql作为key查找Statement对象，存在就使用，不存在就创建，用完后，不关闭Statement对象，而是放置于Map<String, Statement>内，供下一次使用。   
### **BatchExecutor**
执行update（没有select，JDBC批处理不支持select），将所有sql都添加到批处理中（addBatch()），等待统一执行（executeBatch()），它缓存了多个Statement对象，每个Statement对象都是addBatch()完毕后，等待逐一执行executeBatch()批处理。与JDBC批处理相同。  
**作用范围**在SqlSession生命周期范围。

执行过程：步骤一，MyBatis根据Configuration来构建StatementHandler  
                  步骤二，使用prepareStatement方法，对SQL编译并对参数进行初始化  
                  步骤三，调用prepareStatement的prepare()进行预编译和基础设置，再通过StatementHandler的parameterize()来设置参数并执行  
                  步骤四，resultHandler再组装查询结果返回给调用者。

